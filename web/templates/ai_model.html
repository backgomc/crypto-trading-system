<!-- 파일 경로: web/templates/ai_model.html -->
<!-- 코드명: AI 모델 관리 페이지 템플릿 (새 지표 추가 버전) -->

{% extends "base.html" %}

{% block title %}NHBot - AI 모델 관리{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/ai_model.css') }}">
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- 페이지 헤더 -->
    <div class="d-flex justify-content-between align-items-center mb-4 page-header">
        <h2 class="mb-0">
            <i class="bi bi-cpu me-2"></i>AI 모델 관리
        </h2>
        <div class="current-time">
            <i class="bi bi-clock me-1"></i>
            <span id="currentTime"></span>
        </div>
    </div>

    <div class="row">
        <!-- 좌측: 학습 설정 및 실행 -->
        <div class="col-lg-8 mb-4">
            <!-- 학습 지표 선택 (개선된 UI) -->
            <div class="card main-card mb-4">
                <div class="card-header">
                    <h5>
                        <i class="bi bi-graph-up me-2"></i>학습 지표 선택
                        <span class="badge bg-primary ms-2" id="totalSelectedCount">0개 선택</span>
                    </h5>
                </div>
                <div class="card-body">
                    <!-- 핵심 지표 섹션 (선택 가능하게 변경) -->
                    <div class="indicator-section mb-4">
                        <h6 class="section-title">
                            <i class="bi bi-star-fill text-warning me-2"></i>핵심 지표
                            <small class="text-muted ms-2">(원웨이 장 대응 특화)</small>
                            <span class="badge bg-info float-end" id="essentialIndicatorCount">0개 선택</span>
                        </h6>
                        <p class="section-description text-muted small mb-3">
                            <i class="bi bi-info-circle me-1"></i>
                            원웨이 장 감지와 추세 전환점 포착에 직접적으로 필요한 핵심 지표들입니다. AI 모델이 매매 여부를 결정하는 가장 중요한 근거가 됩니다.
                        </p>
                        <div class="essential-indicators-grid">
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="📊 가격 데이터 (Price Data)&#10;&#10;용도: 모든 기술적 분석의 기초 데이터&#10;&#10;포함 내용:&#10;• 종가: 해당 캔들의 마감 가격&#10;• 가격 변화율: 이전 대비 % 변화&#10;• 고저 범위: 고가-저가 차이&#10;&#10;왜 중요한가?&#10;가격의 움직임 자체가 가장 순수한 시장 신호입니다. 다른 모든 지표들은 이 가격 데이터를 가공한 것입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_price" checked class="form-check-input indicator-checkbox" data-indicator="price">
                                    <label class="indicator-name" for="indicator_price">가격 데이터</label>
                                    <span class="indicator-badge">3</span>
                                </div>
                                <small class="indicator-desc">종가, 변화율, 고저범위</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="📈 MACD (이동평균 수렴확산)&#10;&#10;용도: 추세 전환점을 포착하는 핵심 지표&#10;&#10;계산 방법:&#10;• MACD선 = 12일 EMA - 26일 EMA&#10;• 시그널선 = MACD의 9일 EMA&#10;• 히스토그램 = MACD - 시그널&#10;&#10;매매 신호:&#10;• MACD가 시그널선을 상향 돌파 → 매수 신호&#10;• MACD가 시그널선을 하향 돌파 → 매도 신호&#10;&#10;NHBot에서의 역할:&#10;리밸런싱 타이밍을 결정하는 가장 중요한 지표입니다. 15분봉 MACD 전환이 매매의 핵심 트리거입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_macd" checked class="form-check-input indicator-checkbox" data-indicator="macd">
                                    <label class="indicator-name" for="indicator_macd">MACD</label>
                                    <span class="indicator-badge">3</span>
                                </div>
                                <small class="indicator-desc">MACD, 시그널, 히스토그램</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="🔥 RSI (상대강도지수)&#10;&#10;용도: 과매수/과매도 구간을 판단하는 모멘텀 지표&#10;&#10;해석 방법:&#10;• RSI > 70: 과매수 구간 (하락 전환 가능성)&#10;• RSI < 30: 과매도 구간 (상승 전환 가능성)&#10;• 50 기준: 상승/하락 추세 판단&#10;&#10;실전 활용:&#10;극단적인 RSI 값(80 이상, 20 이하)은 강한 추세를 의미하기도 합니다. 다이버전스(가격과 RSI의 반대 움직임)는 추세 전환의 조기 신호입니다.&#10;&#10;NHBot 활용:&#10;과열된 시장 상황을 감지하여 리밸런싱 크기를 조절합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_rsi" checked class="form-check-input indicator-checkbox" data-indicator="rsi">
                                    <label class="indicator-name" for="indicator_rsi">RSI</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">14일 RSI</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="표준편차를 이용한 변동성 채널. 밴드 상단/하단 터치 시 반전 가능성이 높습니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_bb" checked class="form-check-input indicator-checkbox" data-indicator="bb">
                                    <label class="indicator-name" for="indicator_bb">볼린저밴드</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">위치, 폭</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="평균 실제 범위. 시장의 변동성을 측정하는 지표로, 손절/익절 레벨 설정에 활용됩니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_atr" checked class="form-check-input indicator-checkbox" data-indicator="atr">
                                    <label class="indicator-name" for="indicator_atr">ATR</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">평균 실제 범위</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="거래량 분석 지표. 거래량 비율, 누적 거래량 델타(CVD)로 매수/매도 압력을 파악합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_volume" checked class="form-check-input indicator-checkbox" data-indicator="volume">
                                    <label class="indicator-name" for="indicator_volume">거래량</label>
                                    <span class="indicator-badge">3</span>
                                </div>
                                <small class="indicator-desc">비율, CVD, CVD 기울기</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="평균 방향성 지수. 25 이상이면 추세가 강함을 의미합니다. 추세의 강도를 측정합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_adx" checked class="form-check-input indicator-checkbox" data-indicator="adx">
                                    <label class="indicator-name" for="indicator_adx">ADX</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">추세강도, 기울기</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="아룬 오실레이터. 새로운 추세의 시작을 조기에 감지하는 지표입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_aroon" checked class="form-check-input indicator-checkbox" data-indicator="aroon">
                                    <label class="indicator-name" for="indicator_aroon">Aroon</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">추세 전환 타이밍</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="연속 상승/하락 횟수 카운터. 한 방향으로 몇 번 연속 움직였는지 추적합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_consecutive" checked class="form-check-input indicator-checkbox" data-indicator="consecutive">
                                    <label class="indicator-name" for="indicator_consecutive">연속 카운터</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">연속 상승/하락</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="1시간봉, 4시간봉 등 다중 시간대 추세 분석. 시간대별 추세 일치도를 확인합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_trend" checked class="form-check-input indicator-checkbox" data-indicator="trend">
                                    <label class="indicator-name" for="indicator_trend">다중 시간대</label>
                                    <span class="indicator-badge">4</span>
                                </div>
                                <small class="indicator-desc">1H, 4H 추세, 정렬도</small>
                            </div>
                            <!-- 🆕 핵심 지표로 이동된 중요 지표들 -->
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="⭐ HH/LL 카운터 (Higher Highs/Lower Lows)&#10;&#10;🎯 원웨이 장 감지의 핵심!&#10;&#10;용도: 추세의 지속성을 판단하는 가장 명확한 지표&#10;&#10;측정 내용:&#10;• HH(Higher High): 이전 고점보다 높은 고점 형성 횟수&#10;• LL(Lower Low): 이전 저점보다 낮은 저점 형성 횟수&#10;• 추세 점수: 연속 HH/LL 발생 빈도&#10;&#10;원웨이 장 신호:&#10;• 연속 5회 이상 HH → 강력한 상승 원웨이&#10;• 연속 5회 이상 LL → 강력한 하락 원웨이&#10;&#10;NHBot 핵심 전략:&#10;이 지표가 높은 값을 보일 때 AI는 '지금은 리밸런싱하면 안 된다'고 판단합니다. 원웨이 장에서의 손실을 방지하는 가장 중요한 안전장치입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_hhll" checked class="form-check-input indicator-checkbox" data-indicator="hhll">
                                    <label class="indicator-name" for="indicator_hhll">HH/LL 카운터 ⭐</label>
                                    <span class="indicator-badge">3</span>
                                </div>
                                <small class="indicator-desc">고점/저점 갱신 추적</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="⭐ Z-score (표준점수)&#10;&#10;용도: 현재 가격이 평균에서 얼마나 벗어났는지 측정&#10;&#10;계산 방법:&#10;Z = (현재가격 - 평균) ÷ 표준편차&#10;&#10;해석:&#10;• Z > +2: 평균보다 2 표준편차 위 (매우 과매수)&#10;• Z < -2: 평균보다 2 표준편차 아래 (매우 과매도)&#10;• -1 ~ +1: 정상 범위 (68% 확률)&#10;&#10;평균 회귀 전략:&#10;극단적인 Z-score는 평균으로 돌아올 가능성이 높습니다. +3 또는 -3을 넘으면 99.7% 확률로 평균 회귀가 발생합니다.&#10;&#10;NHBot 활용:&#10;극단적 상황에서 리밸런싱 크기를 늘려 수익을 극대화합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_zscore" checked class="form-check-input indicator-checkbox" data-indicator="zscore">
                                    <label class="indicator-name" for="indicator_zscore">Z-score ⭐</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">평균 회귀 지표</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="⭐ Market Structure Break (시장 구조 돌파)&#10;&#10;용도: 주요 지지/저항선 돌파를 감지하여 추세 전환 확인&#10;&#10;감지 내용:&#10;• 주요 고점 돌파 → 상승 추세 확정&#10;• 주요 저점 돌파 → 하락 추세 확정&#10;• 돌파 강도: 거래량과 함께 측정&#10;&#10;중요성:&#10;단순한 가격 돌파가 아닌 '구조적 변화'를 감지합니다. 가짜 돌파(훼이크)를 필터링하여 진짜 추세 전환만 포착합니다.&#10;&#10;NHBot 전략:&#10;시장 구조가 깨질 때 포지션 조정을 일시 중단하고, 새로운 추세가 확립될 때까지 대기합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_market_structure" checked class="form-check-input indicator-checkbox" data-indicator="market_structure">
                                    <label class="indicator-name" for="indicator_market_structure">Market Structure ⭐</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">시장 구조 돌파</small>
                            </div>
                            <div class="indicator-card essential" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="⭐ 추세 강도 종합 점수&#10;&#10;용도: 여러 지표를 종합하여 추세 강도를 점수화&#10;&#10;계산 요소:&#10;• ADX 값 (추세 강도)&#10;• 연속 상승/하락 횟수&#10;• 거래량 증가율&#10;• 다중 시간대 일치도&#10;&#10;점수 해석:&#10;• +80 이상: 매우 강한 상승 추세&#10;• +50 ~ +80: 상승 추세&#10;• -50 ~ +50: 횡보/불확실&#10;• -80 이하: 매우 강한 하락 추세&#10;&#10;NHBot 핵심:&#10;점수가 ±80을 넘으면 원웨이 장으로 판단하고 리밸런싱을 최소화합니다. 이 점수가 AI의 최종 의사결정에 가장 큰 영향을 미칩니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_trend_strength" checked class="form-check-input indicator-checkbox" data-indicator="trend_strength">
                                    <label class="indicator-name" for="indicator_trend_strength">추세 강도 점수 ⭐</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">종합 추세 점수</small>
                            </div>
                        </div>
                    </div>

                    <!-- 선택적 지표 섹션 -->
                    <div class="indicator-section mb-4">
                        <h6 class="section-title">
                            <i class="bi bi-plus-circle me-2"></i>선택적 지표
                            <small class="text-muted ms-2">(필요시 추가)</small>
                            <span class="badge bg-info float-end" id="optionalIndicatorCount">0개 선택</span>
                        </h6>
                        <p class="section-description text-muted small mb-3">
                            <i class="bi bi-info-circle me-1"></i>
                            기본적이고 널리 사용되는 보조 지표들입니다. 핵심 지표를 보완하여 더 정밀한 분석이 가능하지만, 다른 지표와 중복되는 정보가 있을 수 있습니다.
                        </p>
                        <div class="optional-indicators-grid">
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="단순이동평균. 지정 기간의 종가를 단순 평균한 값입니다. 가격의 전반적인 방향성을 파악합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_sma" class="form-check-input indicator-checkbox" data-indicator="sma">
                                    <label class="indicator-name" for="indicator_sma">SMA</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">단순이동평균</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="지수이동평균. 최근 가격에 더 큰 가중치를 두는 이동평균입니다. SMA보다 빠르게 반응합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_ema" class="form-check-input indicator-checkbox" data-indicator="ema">
                                    <label class="indicator-name" for="indicator_ema">EMA</label>
                                    <span class="indicator-badge">3</span>
                                </div>
                                <small class="indicator-desc">지수이동평균</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="스토캐스틱 오실레이터. 현재 가격이 일정 기간 고저 범위의 어디에 위치하는지 측정합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_stoch" class="form-check-input indicator-checkbox" data-indicator="stoch">
                                    <label class="indicator-name" for="indicator_stoch">스토캐스틱</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">K%, D%</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="윌리엄스 %R. 스토캐스틱과 유사하지만 반대로 표시됩니다. -20 이상이면 과매수, -80 이하면 과매도입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_williams" class="form-check-input indicator-checkbox" data-indicator="williams">
                                    <label class="indicator-name" for="indicator_williams">Williams %R</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">모멘텀 지표</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="자금흐름지표. RSI에 거래량을 가중한 지표입니다. 80 이상이면 과매수, 20 이하면 과매도입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_mfi" class="form-check-input indicator-checkbox" data-indicator="mfi">
                                    <label class="indicator-name" for="indicator_mfi">MFI</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">자금흐름지표</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="거래량 가중 평균 가격. 실제 거래가 이루어진 평균 가격을 나타냅니다. 기관의 평균 매수가로 해석됩니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_vwap" class="form-check-input indicator-checkbox" data-indicator="vwap">
                                    <label class="indicator-name" for="indicator_vwap">VWAP</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">거래량가중평균</small>
                            </div>
                            <div class="indicator-card optional" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="20일 변동성. 가격의 표준편차로 시장의 불안정성을 측정합니다. 높을수록 가격 변동이 큽니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_volatility" class="form-check-input indicator-checkbox" data-indicator="volatility">
                                    <label class="indicator-name" for="indicator_volatility">변동성</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">20일 변동성</small>
                            </div>
                        </div>
                    </div>

                    <!-- 🆕 고급 지표 섹션 (새로 추가) -->
                    <div class="indicator-section">
                        <h6 class="section-title">
                            <i class="bi bi-lightning-fill text-danger me-2"></i>고급 지표
                            <small class="text-muted ms-2">(고급 전략용)</small>
                            <span class="badge bg-info float-end" id="advancedIndicatorCount">0개 선택</span>
                        </h6>
                        <p class="section-description text-muted small mb-3">
                            <i class="bi bi-info-circle me-1"></i>
                            전문 트레이더들이 사용하는 복잡한 계산 기반 지표들입니다. 더 많은 데이터와 연산이 필요하지만, 일반 지표가 놓치는 특수한 시장 상황을 포착할 수 있습니다.
                        </p>
                        <div class="advanced-indicators-grid">
                            <!-- 채널 지표 -->
                            <div class="indicator-card advanced" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="켈트너 채널. ATR 기반 동적 채널로 볼린저밴드보다 안정적입니다. 브레이크아웃 전략에 효과적입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_keltner" class="form-check-input indicator-checkbox" data-indicator="keltner">
                                    <label class="indicator-name" for="indicator_keltner">Keltner Channel</label>
                                    <span class="indicator-badge">4</span>
                                </div>
                                <small class="indicator-desc">볼린저밴드 대안</small>
                            </div>
                            <div class="indicator-card advanced" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="돈치안 채널. N일간 최고가/최저가로 형성되는 채널입니다. 터틀 트레이딩 시스템의 핵심 지표입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_donchian" class="form-check-input indicator-checkbox" data-indicator="donchian">
                                    <label class="indicator-name" for="indicator_donchian">Donchian Channel</label>
                                    <span class="indicator-badge">4</span>
                                </div>
                                <small class="indicator-desc">고점/저점 돌파</small>
                            </div>
                            
                            <!-- 거래량 고급 지표 -->
                            <div class="indicator-card advanced" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="Volume Point of Control. 가장 많은 거래량이 발생한 가격대입니다. 강력한 지지/저항선으로 작용합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_vpoc" class="form-check-input indicator-checkbox" data-indicator="vpoc">
                                    <label class="indicator-name" for="indicator_vpoc">VPOC</label>
                                    <span class="indicator-badge">2</span>
                                </div>
                                <small class="indicator-desc">가격대별 거래량</small>
                            </div>
                            <div class="indicator-card advanced" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="주문 플로우 불균형. 매수/매도 주문량 차이를 분석하여 단기 방향성을 예측합니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_order_flow" class="form-check-input indicator-checkbox" data-indicator="order_flow">
                                    <label class="indicator-name" for="indicator_order_flow">Order Flow</label>
                                    <span class="indicator-badge">1</span>
                                </div>
                                <small class="indicator-desc">주문 플로우 불균형</small>
                            </div>
                            
                            <!-- 가격 구조 지표 -->
                            <div class="indicator-card advanced" data-bs-toggle="tooltip" data-bs-placement="top" 
                                 title="피봇 포인트. 전일 고가/저가/종가로 계산하는 지지/저항선입니다. 데이트레이딩의 기본 레벨입니다.">
                                <div class="indicator-header">
                                    <input type="checkbox" id="indicator_pivot" class="form-check-input indicator-checkbox" data-indicator="pivot">
                                    <label class="indicator-name" for="indicator_pivot">Pivot Points</label>
                                    <span class="indicator-badge">4</span>
                                </div>
                                <small class="indicator-desc">피봇 지지/저항</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 학습 파라미터 설정 -->
            <div class="card main-card mb-4">
                <div class="card-header">
                    <h5>
                        <i class="bi bi-sliders me-2"></i>학습 파라미터 설정
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">학습 데이터 기간</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="trainingDays" value="365" min="30" max="1095">
                                <span class="input-group-text">일</span>
                            </div>
                            <div class="form-text">과거 몇 일간의 데이터로 학습할지 설정</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">에폭 (Epochs)</label>
                            <input type="number" class="form-control" id="epochs" value="100" min="10" max="1000">
                            <div class="form-text">모델 학습 반복 횟수</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">배치 크기 (Batch Size)</label>
                            <input type="number" class="form-control" id="batchSize" value="32" min="8" max="128">
                            <div class="form-text">한 번에 처리할 데이터 개수</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">학습률 (Learning Rate)</label>
                            <input type="number" class="form-control" id="learningRate" value="0.001" min="0.0001" max="0.1" step="0.0001">
                            <div class="form-text">모델 가중치 업데이트 속도</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">시퀀스 길이</label>
                            <input type="number" class="form-control" id="sequenceLength" value="60" min="10" max="200">
                            <div class="form-text">예측에 사용할 과거 데이터 개수 (분)</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label class="form-label fw-medium">검증 비율</label>
                            <div class="input-group">
                                <input type="number" class="form-control" id="validationSplit" value="20" min="10" max="30">
                                <span class="input-group-text">%</span>
                            </div>
                            <div class="form-text">검증용으로 사용할 데이터 비율</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 학습 실행 및 모니터링 -->
            <div class="card main-card">
                <div class="card-header">
                    <h5>
                        <i class="bi bi-play-circle me-2"></i>학습 실행 및 모니터링
                    </h5>
                </div>
                <div class="card-body">
                    <!-- 학습 제어 버튼 -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="d-flex gap-2">
                                <button class="btn btn-success" id="startTrainingBtn">
                                    <i class="bi bi-play-fill me-1"></i>학습 시작
                                </button>
                                <button class="btn btn-danger" id="stopTrainingBtn" disabled>
                                    <i class="bi bi-stop-fill me-1"></i>학습 중지
                                </button>
                                <button class="btn btn-outline-secondary" id="resetParametersBtn">
                                    <i class="bi bi-arrow-clockwise me-1"></i>기본값 복원
                                </button>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <div class="training-status">
                                <span class="badge bg-secondary" id="trainingStatus">대기 중</span>
                            </div>
                        </div>
                    </div>

                    <!-- 학습 진행률 -->
                    <div id="trainingProgress" style="display: none;">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label class="form-label fw-medium">전체 진행률</label>
                                <div class="progress mb-2" style="height: 25px;">
                                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                                         id="overallProgress" role="progressbar" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="progressText">0/100 에폭</small>
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-medium">현재 에폭 진행률</label>
                                <div class="progress mb-2" style="height: 25px;">
                                    <div class="progress-bar bg-info progress-bar-striped progress-bar-animated" 
                                         id="epochProgress" role="progressbar" style="width: 0%"></div>
                                </div>
                                <small class="text-muted" id="epochText">0/100 배치</small>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="training-info">
                                    <div class="info-item">
                                        <span class="label">시작 시간:</span>
                                        <span id="startTime">-</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">경과 시간:</span>
                                        <span id="elapsedTime">00:00:00</span>
                                    </div>
                                    <div class="info-item">
                                        <span class="label">예상 완료:</span>
                                        <span id="estimatedTime">-</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="training-metrics">
                                    <div class="metric-item">
                                        <span class="label">Loss:</span>
                                        <span id="currentLoss" class="value">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="label">Accuracy:</span>
                                        <span id="currentAccuracy" class="value">-</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="label">Val Loss:</span>
                                        <span id="valLoss" class="value">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 우측: 모델 히스토리 및 관리 -->
        <div class="col-lg-4">
            <!-- 현재 활성 모델 -->
            <div class="card main-card mb-4">
                <div class="card-header">
                    <h5>
                        <i class="bi bi-star me-2"></i>현재 활성 모델
                    </h5>
                </div>
                <div class="card-body">
                    <div class="active-model-info">
                        <div class="model-name">
                            <strong id="activeModelName">모델 없음</strong>
                        </div>
                        <div class="model-stats">
                            <div class="stat-item">
                                <span class="label">정확도:</span>
                                <span class="value text-success" id="activeModelAccuracy">-</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">학습일:</span>
                                <span class="value" id="activeModelDate">-</span>
                            </div>
                            <div class="stat-item">
                                <span class="label">상태:</span>
                                <span id="activeModelBadge" class="badge bg-secondary">비활성</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 모델 히스토리 -->
            <div class="card main-card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="bi bi-clock-history me-2"></i>모델 히스토리
                    </h5>
                    <button class="btn btn-outline-danger btn-sm" id="cleanupModelsBtn">
                        <i class="bi bi-trash me-1"></i>정리
                    </button>
                </div>
                <div class="card-body p-0">
                    <div class="model-list">
                        <!-- JavaScript로 동적 생성 -->
                    </div>
                </div>
            </div>

            <!-- 자동 학습 스케줄러 -->
            <div class="card main-card">
                <div class="card-header">
                    <h5>
                        <i class="bi bi-calendar-event me-2"></i>자동 학습 스케줄러
                    </h5>
                </div>
                <div class="card-body">
                    <div class="form-check form-switch mb-3">
                        <input class="form-check-input" type="checkbox" id="autoRetraining" checked>
                        <label class="form-check-label fw-medium" for="autoRetraining">
                            자동 재학습 활성화
                        </label>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label fw-medium">재학습 간격</label>
                        <select class="form-select" id="retrainingInterval">
                            <option value="86400">매일 (24시간)</option>
                            <option value="172800">2일마다</option>
                            <option value="604800">매주 (7일)</option>
                            <option value="1209600">2주마다</option>
                        </select>
                    </div>
                    
                    <div class="next-training">
                        <small class="text-muted">다음 자동 학습: </small>
                        <small id="nextTraining">-</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- 토스트 컨테이너 -->
<div id="toastContainer"></div>

{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/ai_model.js') }}"></script>
{% endblock %}